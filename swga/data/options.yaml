# This file is used to build the arguments to each subcommand, and to populate
# the default_parameters.cfg file in `swga init`.
#
# Only the `desc` and `default` fields are used in the .cfg file; all other
# fields are ignored. 
#
# Interpolation notes:
#   "{...}" entries are filled in by `swga init` 
#   "%(...)" entries are interpolated by the config parser
#   &xyz is a label, *xyz is a reference to that label resolved by the YAML
#   parser 
---
INTERNAL:
  fg_genome_fp: &fg "{fg_genome_fp}"
  bg_genome_fp: &bg "{bg_genome_fp}"
  fg_length: &fglen "{fg_length}"
  bg_length: &bglen "{bg_length}"
  min_fg_rate: &fgrate "{min_fg_rate}"
  min_fg_bind: &fgbind "{min_fg_bind}"
  max_bg_rate: &bgrate "{max_bg_rate}"
  max_bg_bind: &bgbind "{max_bg_bind}"
  primer_db: &primerdb primers.db

count:
  desc: >
    Count kmers in a foreground genome, then count those in a
    background genome, and add results to database
  primer_db:
    default: *primerdb
    desc: primer database name
  fg_genome_fp: 
    default: *fg
    desc: path to foreground (aka target) genome
  bg_genome_fp:
    default: *bg
    desc: path to background genome
  min_size:
    default: 5
    desc: minimum kmer size
    type: int
  max_size:
    default: 12
    desc: maximum kmer size
    type: int
  min_fg_bind:
    default: *fgbind
    desc: minimum primer binding sites (autofilled)
    type: int
  max_bg_bind:
    default: *bgbind
    desc: maximum primer binding sites (autofilled)
    type: int
  exclude_fp:
    default: None
    desc: >
      (FASTA) any primers appearing here above a threshold will be excluded
  exclude_threshold:
    default: 1
    desc: primers appearing >= this in exclude_fp will be excluded
    type: int


summary:
  desc: Summarizes current primer and sets database.
  primer_db:
    default: *primerdb
    desc: primer database name
  bg_length:
    default: *bglen
    desc: length of the background genome (autofilled by swga init)
    type: int
  fg_length:
    default: *fglen
    desc: length of the foreground genome (autofilled by swga init)
    type: int

filter: 
  desc: Activate suitable primers in a database
  primer_db:
    default: *primerdb
    desc: primer database name
  fg_genome_fp: 
    default: *fg
    desc: path to foreground (aka target) genome  
  max_bg_bind:
    default: 12000
    desc: max times a primer can bind to bg genome (currently unused)
    type: int
  num_primers:
    default: 200
    desc: max number of primers to keep after filtering
  bg_length:
    default: *bglen
    desc: length of the background genome (autofilled by swga init)
    type: int
  fg_length:
    default: *fglen
    desc: length of the foreground genome (autofilled by swga init)
    type: int
  min_avg_fg_rate:
    default: *fgrate
    desc: minimum average binding frequency over the foreground genome
    type: float
  max_avg_bg_rate:
    default: *bgrate
    desc: maximum average binding frequency over the background genome
    type: float
  min_tm:
    default: 0
    desc: minimum primer melting temperature (C)
    type: float
  max_tm:
    default: 100
    desc: maximum primer melting temperature (C)
    type: float

find_sets:
  desc: Find sets of compatible primers in a primer compatibility graph
  primer_db:
    default: *primerdb
    desc: primer database name
  min_size:
    default: 2
    desc: minimum size of primer sets
  max_size:
    default: 7
    desc: max size of primer sets
  max_hetdimer_bind:
    default: 3
    desc: max number of consecutive complimentary bases between two primers  
  min_bg_bind_dist:
    default: 30000
    desc: min avg distance between primers in the bg genome
  bg_genome_len:
    default: *bglen
    desc: length of background genome (autofilled by swga init)
    
score:
  desc: Filter and score primer sets
  primer_db:
    default: *primerdb
    desc: primer database name
  fg_genome_fp: 
    default: *fg
    desc: path to foreground (aka target) genome  
  max_fg_bind_dist:
    default: 36000
    desc: Max distance between primers on the foreground genome
    type: int
  max_sets:
    default: 500
    desc: Max number of sets to check
    type: int
  score_expression:
    default: "(fg_dist_mean*fg_dist_gini)/(bg_ratio)"
    desc: >
      Specify an expression to calculate the set score. Code must only use the
      following variables: set_size, fg_dist_mean, fg_dist_std, fg_dist_gini,
      fg_dist_max, bg_ratio. Expression must have valid Python syntax.
  plugin_score_fun:
    default: None
    desc: >
      Specify a path to a scoring function to use instead of the normal
      scoring function, to create custom metrics or output. For help, see
      wiki. Incompatible with --score_expression argument.

      
setopt:
  desc: change a value in the parameters file
  incfg: False
  command:
    default: None
    desc: the command whose option is being modified
    ctype: arg
  opt:
    default: None
    desc: the option to change
    ctype: arg
  value:
    default: None
    desc: the new value of the option
    ctype: arg